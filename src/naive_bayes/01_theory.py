"""
===========================================
ç¬¬ä¸€è¯¾ï¼šè´å¶æ–¯å®šç†åŸºç¡€
===========================================

åœ¨å­¦ä¹ æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç†è§£è´å¶æ–¯å®šç†ã€‚

è´å¶æ–¯å®šç†çš„æ ¸å¿ƒæ€æƒ³ï¼š
- ç”¨å·²çŸ¥çš„ä¿¡æ¯ï¼ˆå…ˆéªŒçŸ¥è¯†ï¼‰æ¥æ›´æ–°æˆ‘ä»¬çš„åˆ¤æ–­ï¼ˆåéªŒæ¦‚ç‡ï¼‰

ä¸¾ä¸ªä¾‹å­ ğŸŒ§ï¸ï¼š
- é—®é¢˜ï¼šä»Šå¤©ä¼šä¸‹é›¨å—ï¼Ÿ
- å…ˆéªŒçŸ¥è¯†ï¼šæ ¹æ®å†å²æ•°æ®ï¼Œè¿™ä¸ªå­£èŠ‚ 30% çš„å¤©ä¼šä¸‹é›¨
- æ–°è¯æ®ï¼šä»Šå¤©æ—©ä¸Šå¤©å¾ˆé˜´
- æ›´æ–°åçš„åˆ¤æ–­ï¼šå¦‚æœå¤©é˜´ï¼Œä¸‹é›¨çš„æ¦‚ç‡ä¸Šå‡åˆ° 70%

è¿™å°±æ˜¯è´å¶æ–¯çš„æ€ç»´æ–¹å¼ï¼
"""

# ============================================
# ç¬¬ä¸€éƒ¨åˆ†ï¼šä¸€ä¸ªç®€å•çš„ä¾‹å­ - åŒ»å­¦è¯Šæ–­
# ============================================


def medical_diagnosis_example():
    """
    åŒ»å­¦è¯Šæ–­ä¾‹å­ï¼š
    - æŸç§ç–¾ç—…åœ¨äººç¾¤ä¸­çš„æ‚£ç—…ç‡æ˜¯ 1%ï¼ˆå…ˆéªŒæ¦‚ç‡ï¼‰
    - æ£€æµ‹æ–¹æ³•çš„å‡†ç¡®ç‡ï¼š
        - å¦‚æœæœ‰ç—…ï¼Œ99% ä¼šæ£€æµ‹å‡ºé˜³æ€§ï¼ˆæ•æ„Ÿæ€§ï¼‰
        - å¦‚æœæ²¡ç—…ï¼Œ5% ä¼šè¯¯æ£€ä¸ºé˜³æ€§ï¼ˆå‡é˜³æ€§ç‡ï¼‰

    é—®é¢˜ï¼šå¦‚æœä¸€ä¸ªäººæ£€æµ‹ä¸ºé˜³æ€§ï¼Œä»–çœŸçš„æœ‰ç—…çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ
    """

    # å…ˆéªŒæ¦‚ç‡
    p_disease = 0.01  # æ‚£ç—…æ¦‚ç‡
    p_no_disease = 0.99  # æ²¡ç—…æ¦‚ç‡

    # ä¼¼ç„¶ï¼ˆæ¡ä»¶æ¦‚ç‡ï¼‰
    p_positive_given_disease = 0.99  # æœ‰ç—…æ£€æµ‹ä¸ºé˜³æ€§çš„æ¦‚ç‡
    p_positive_given_no_disease = 0.05  # æ²¡ç—…ä½†æ£€æµ‹ä¸ºé˜³æ€§çš„æ¦‚ç‡

    # è®¡ç®— P(é˜³æ€§) - å…¨æ¦‚ç‡å…¬å¼
    p_positive = (
        p_positive_given_disease * p_disease
        + p_positive_given_no_disease * p_no_disease
    )

    # è´å¶æ–¯å®šç†ï¼šP(æœ‰ç—…|é˜³æ€§) = P(é˜³æ€§|æœ‰ç—…) Ã— P(æœ‰ç—…) / P(é˜³æ€§)
    p_disease_given_positive = (p_positive_given_disease * p_disease) / p_positive

    print("=" * 50)
    print("åŒ»å­¦è¯Šæ–­ä¾‹å­")
    print("=" * 50)
    print(f"å…ˆéªŒæ¦‚ç‡ P(æœ‰ç—…) = {p_disease:.2%}")
    print(f"P(é˜³æ€§|æœ‰ç—…) = {p_positive_given_disease:.2%}")
    print(f"P(é˜³æ€§|æ²¡ç—…) = {p_positive_given_no_disease:.2%}")
    print(f"P(é˜³æ€§) = {p_positive:.4f}")
    print("-" * 50)
    print(f"åéªŒæ¦‚ç‡ P(æœ‰ç—…|é˜³æ€§) = {p_disease_given_positive:.2%}")
    print("\nğŸ’¡ ç»“è®ºï¼šå³ä½¿æ£€æµ‹ä¸ºé˜³æ€§ï¼ŒçœŸçš„æœ‰ç—…çš„æ¦‚ç‡ä¹Ÿåªæœ‰çº¦ 17%ï¼")
    print("   è¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦å¤æŸ¥çš„åŸå› ã€‚")


# ============================================
# ç¬¬äºŒéƒ¨åˆ†ï¼šè´å¶æ–¯å®šç†çš„ä¸€èˆ¬å½¢å¼
# ============================================


def bayes_theorem(prior: float, likelihood: float, evidence: float) -> float:
    """
    è´å¶æ–¯å®šç†å…¬å¼ï¼š

    P(A|B) = P(B|A) Ã— P(A) / P(B)

    å‚æ•°:
        prior: P(A) - å…ˆéªŒæ¦‚ç‡
        likelihood: P(B|A) - ä¼¼ç„¶
        evidence: P(B) - è¯æ®

    è¿”å›:
        posterior: P(A|B) - åéªŒæ¦‚ç‡
    """
    posterior = (likelihood * prior) / evidence
    return posterior


# ============================================
# ç¬¬ä¸‰éƒ¨åˆ†ï¼šä¸ºä»€ä¹ˆæœ´ç´ è´å¶æ–¯å«"æœ´ç´ "ï¼Ÿ
# ============================================


def explain_naive_assumption():
    """
    è§£é‡Šæœ´ç´ å‡è®¾
    """
    explanation = """
    ============================================
    ä¸ºä»€ä¹ˆå«"æœ´ç´ "è´å¶æ–¯ï¼Ÿ
    ============================================
    
    å‡è®¾æˆ‘ä»¬è¦åˆ¤æ–­ä¸€å°é‚®ä»¶æ˜¯å¦æ˜¯åƒåœ¾é‚®ä»¶ã€‚
    
    é‚®ä»¶å†…å®¹ï¼š"å…è´¹ è·å– å½©ç¥¨ ä¸­å¥–"
    
    æ ‡å‡†è´å¶æ–¯æ–¹æ³•éœ€è¦è®¡ç®—ï¼š
    P("å…è´¹" AND "è·å–" AND "å½©ç¥¨" AND "ä¸­å¥–" | åƒåœ¾é‚®ä»¶)
    
    è¿™ä¸ªè”åˆæ¦‚ç‡å¾ˆéš¾ä¼°è®¡ï¼å› ä¸ºéœ€è¦å¤§é‡æ•°æ®ã€‚
    
    æœ´ç´ å‡è®¾ï¼šæ‰€æœ‰ç‰¹å¾ç›¸äº’ç‹¬ç«‹ï¼
    
    äºæ˜¯å¯ä»¥ç®€åŒ–ä¸ºï¼š
    P("å…è´¹"|åƒåœ¾é‚®ä»¶) Ã— P("è·å–"|åƒåœ¾é‚®ä»¶) Ã— P("å½©ç¥¨"|åƒåœ¾é‚®ä»¶) Ã— P("ä¸­å¥–"|åƒåœ¾é‚®ä»¶)
    
    è¿™äº›å•ç‹¬çš„æ¦‚ç‡å°±å®¹æ˜“ç»Ÿè®¡äº†ï¼
    
    è™½ç„¶"æœ´ç´ "ï¼ˆå¤©çœŸï¼‰ï¼Œä½†æ•ˆæœå‡ºå¥‡çš„å¥½ï¼
    ============================================
    """
    print(explanation)


# ============================================
# ç¬¬å››éƒ¨åˆ†ï¼šæ‰‹åŠ¨å®ç°ä¸€ä¸ªç®€å•çš„åˆ†ç±»å™¨
# ============================================


def simple_classifier_example():
    """
    ä¸€ä¸ªç®€å•çš„åˆ†ç±»å™¨ä¾‹å­ï¼šåˆ¤æ–­å¤©æ°”æ˜¯å¦é€‚åˆæ‰“çƒ

    è®­ç»ƒæ•°æ®:
    | å¤©æ°” | æ¸©åº¦ | æ¹¿åº¦ | é£åŠ› | æ‰“çƒï¼Ÿ |
    |------|------|------|------|--------|
    | æ™´   | çƒ­   | é«˜   | å¼±   | å¦     |
    | æ™´   | çƒ­   | é«˜   | å¼º   | å¦     |
    | é˜´   | çƒ­   | é«˜   | å¼±   | æ˜¯     |
    | é›¨   | æ¸©   | é«˜   | å¼±   | æ˜¯     |
    | é›¨   | å‡‰   | æ­£å¸¸ | å¼±   | æ˜¯     |
    | é›¨   | å‡‰   | æ­£å¸¸ | å¼º   | å¦     |
    | é˜´   | å‡‰   | æ­£å¸¸ | å¼º   | æ˜¯     |
    | æ™´   | æ¸©   | é«˜   | å¼±   | å¦     |
    | æ™´   | å‡‰   | æ­£å¸¸ | å¼±   | æ˜¯     |
    | é›¨   | æ¸©   | æ­£å¸¸ | å¼±   | æ˜¯     |
    """

    # ç»Ÿè®¡æ•°æ®
    total = 10
    play_yes = 6  # æ‰“çƒçš„æ¬¡æ•°
    play_no = 4  # ä¸æ‰“çƒçš„æ¬¡æ•°

    # å…ˆéªŒæ¦‚ç‡
    p_yes = play_yes / total
    p_no = play_no / total

    print("=" * 50)
    print("å¤©æ°”åˆ†ç±»å™¨ä¾‹å­")
    print("=" * 50)
    print(f"P(æ‰“çƒ=æ˜¯) = {play_yes}/{total} = {p_yes:.2f}")
    print(f"P(æ‰“çƒ=å¦) = {play_no}/{total} = {p_no:.2f}")

    # æ–°æ ·æœ¬ï¼šå¤©æ°”=æ™´, æ¸©åº¦=å‡‰, æ¹¿åº¦=é«˜, é£åŠ›=å¼º
    # è®¡ç®— P(å„ç‰¹å¾|æ‰“çƒ=æ˜¯) å’Œ P(å„ç‰¹å¾|æ‰“çƒ=å¦)

    # ä»è®­ç»ƒæ•°æ®ç»Ÿè®¡ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼‰
    # P(æ™´|æ˜¯) = 2/6, P(æ™´|å¦) = 3/4
    # P(å‡‰|æ˜¯) = 3/6, P(å‡‰|å¦) = 1/4
    # P(é«˜|æ˜¯) = 2/6, P(é«˜|å¦) = 4/4
    # P(å¼º|æ˜¯) = 2/6, P(å¼º|å¦) = 2/4

    p_features_given_yes = (2 / 6) * (3 / 6) * (2 / 6) * (2 / 6)
    p_features_given_no = (3 / 4) * (1 / 4) * (4 / 4) * (2 / 4)

    # è®¡ç®—åéªŒæ¦‚ç‡ï¼ˆæœªå½’ä¸€åŒ–ï¼‰
    score_yes = p_features_given_yes * p_yes
    score_no = p_features_given_no * p_no

    # å½’ä¸€åŒ–
    total_score = score_yes + score_no
    p_yes_given_features = score_yes / total_score
    p_no_given_features = score_no / total_score

    print("\næ–°æ ·æœ¬ï¼šå¤©æ°”=æ™´, æ¸©åº¦=å‡‰, æ¹¿åº¦=é«˜, é£åŠ›=å¼º")
    print("-" * 50)
    print(f"P(æ˜¯) Ã— P(ç‰¹å¾|æ˜¯) = {score_yes:.6f}")
    print(f"P(å¦) Ã— P(ç‰¹å¾|å¦) = {score_no:.6f}")
    print("-" * 50)
    print(f"P(æ‰“çƒ=æ˜¯|ç‰¹å¾) = {p_yes_given_features:.2%}")
    print(f"P(æ‰“çƒ=å¦|ç‰¹å¾) = {p_no_given_features:.2%}")
    print(
        f"\né¢„æµ‹ç»“æœï¼š{'æ‰“çƒ' if p_yes_given_features > p_no_given_features else 'ä¸æ‰“çƒ'}"
    )


# ============================================
# ä¸»ç¨‹åº
# ============================================

if __name__ == "__main__":
    print("\n" + "ğŸ“ " * 20 + "\n")
    print("æ¬¢è¿å­¦ä¹ æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ï¼")
    print("\n" + "ğŸ“ " * 20 + "\n")

    # 1. åŒ»å­¦è¯Šæ–­ä¾‹å­
    medical_diagnosis_example()

    print("\n")

    # 2. è§£é‡Šæœ´ç´ å‡è®¾
    explain_naive_assumption()

    # 3. ç®€å•åˆ†ç±»å™¨ä¾‹å­
    simple_classifier_example()

    print("\n" + "=" * 50)
    print("ä¸‹ä¸€æ­¥ï¼šè¿è¡Œ 02_gaussian_nb.py å­¦ä¹ é«˜æ–¯æœ´ç´ è´å¶æ–¯")
    print("=" * 50)
